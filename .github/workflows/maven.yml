name: Build AegisGuard PST

on:
  push:
    branches:
      - "1.3.0-PST"
      - "main"
  pull_request:
    branches:
      - "1.3.0-PST"
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: '21'
        distribution: 'temurin'
        cache: maven

    - name: Build with Maven
      # The -U is CRITICAL for your snapshot dependencies (Jobs/mcMMO)
      run: mvn -B -U clean package --file pom.xml

    - name: Upload JAR
      uses: actions/upload-artifact@v4
      with:
        # This will be the name of the download button
        name: AegisGuard-1.3.0-PST
        # The ! excludes the "original-" file so you only get the working one
        path: |
          target/*.jar
          !target/original-*.jar
