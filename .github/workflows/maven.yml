name: Build AegisGuard (Manual Only)

# This section determines WHEN the build runs.
# We have removed 'push' and 'pull_request' so it won't auto-run on commits.
on:
  # This enables the "Run workflow" button in the Actions tab for manual builds.
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: '21'
        distribution: 'temurin'
        cache: maven

    - name: Build with Maven
      # The -U forces updates for snapshots (fixing the Jobs/mcMMO dependencies)
      run: mvn -B -U clean package --file pom.xml

    - name: Upload JAR
      uses: actions/upload-artifact@v4
      with:
        name: AegisGuard-Manual-Build
        # The '!' excludes the "original-" file so you only get the working plugin JAR
        path: |
          target/*.jar
          !target/original-*.jar
